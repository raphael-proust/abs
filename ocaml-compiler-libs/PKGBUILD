#Contributor: Massimiliano Brocchini <brocchini@netseven.it>

pkgname=ocaml-compiler-libs
pkgver=3.12.1
pkgrel=1
pkgdesc="Modules used internally by the Objective Caml (OCaml) compiler"
arch=('i686' 'x86_64')
url="http://caml.inria.fr/"
license=('QPL')
depends=('ocaml')
replaces=('ocaml-compiler-lib')
source=(http://caml.inria.fr/pub/distrib/ocaml-3.12/ocaml-$pkgver.tar.gz)
md5sums=('814a047085f0f901ab7d8e3a4b7a9e65')

build() {
  cd $startdir/src/ocaml-$pkgver
  ./configure -no-tk || return 1
  make world.opt || return 1
}

package() {
  mkdir -p $startdir/pkg/usr/lib/ocaml/compiler-libs || return 1
  install -m 0644 $startdir/src/ocaml-$pkgver/parsing/*.{mli,cmi,cmo,cmx,o} 	\
   $startdir/src/ocaml-$pkgver/typing/*.{mli,cmi,cmo,cmx,o} 				\
   $startdir/src/ocaml-$pkgver/utils/*.{mli,cmi,cmo,cmx,o} 				\
   $startdir/src/ocaml-$pkgver/driver/*.{mli,cmi,cmo,cmx,o} 				\
   $startdir/pkg/usr/lib/ocaml/compiler-libs
  cd $startdir/pkg/usr/lib/ocaml/compiler-libs
  ln -s . driver
  ln -s . utils
  ln -s . parsing
  ln -s . typing
}
